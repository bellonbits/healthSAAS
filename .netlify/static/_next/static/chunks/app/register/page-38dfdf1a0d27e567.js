(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{67972:function(e,s,r){"use strict";r.d(s,{Z:function(){return t}});var a=r(62898);let t=(0,a.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},26926:function(e,s,r){Promise.resolve().then(r.bind(r,5878))},5878:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return Register}});var a=r(57437),t=r(2265),i=r(24033),n=r(61396),o=r.n(n),l=r(90998),d=r(67972),c=r(1295),m=r(5589),u=r(3089),h=r(86582),g=r(6429),p=r(10609),x=r(6454),f=r(71424);let registerWithRetry=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;for(let r=0;r<=s;r++)try{console.log("Registration attempt ".concat(r+1)),r>0&&await new Promise(e=>setTimeout(e,1e3*r));let s=await x.hi.register(e);return s}catch(a){if(console.log("Attempt ".concat(r+1," failed:"),a.message),r===s)throw a;if(a.message.includes("Network Error")||a.message.includes("Failed to fetch")||"NETWORK_ERROR"===a.code){console.log("Trying alternative registration method...");try{let s=await registerWithXHR(e);return s}catch(e){console.log("XHR method also failed:",e);continue}}}throw Error("All registration attempts failed")},registerWithXHR=e=>new Promise((s,r)=>{let a=new XMLHttpRequest;a.open("POST","".concat("http://4.222.216.225:8000","/api/users/register")),a.setRequestHeader("Content-Type","application/json");let t=localStorage.getItem("healthsaas_token");t&&a.setRequestHeader("Authorization","Bearer ".concat(t)),a.timeout=1e4,a.onload=()=>{if(a.status>=200&&a.status<300)try{let e=JSON.parse(a.responseText);s({data:e})}catch(e){s({data:a.responseText})}else r(Error("Registration failed with status ".concat(a.status,": ").concat(a.statusText)))},a.onerror=()=>{r(Error("Network error occurred"))},a.ontimeout=()=>{r(Error("Request timeout"))};try{a.send(JSON.stringify(e))}catch(e){r(Error("Failed to send request"))}});function Register(){let e=(0,i.useRouter)(),[s,r]=(0,t.useState)({name:"",email:"",password:"",confirm_password:""}),[n,w]=(0,t.useState)(!1),handleSubmit=async a=>{if(a.preventDefault(),!n){if(s.password!==s.confirm_password){f.toast.error("Passwords do not match");return}if(s.password.length<6){f.toast.error("Password must be at least 6 characters long");return}if(!s.name.trim()){f.toast.error("Please enter your full name");return}if(!s.email.trim()){f.toast.error("Please enter your email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)){f.toast.error("Please enter a valid email address");return}w(!0);try{let a={name:s.name.trim(),email:s.email.trim().toLowerCase(),password:s.password,confirm_password:s.confirm_password,role:"CHW"};console.log("Starting registration process...",{email:a.email,hasPassword:!!a.password});let t=await registerWithRetry(a);if(console.log("Registration response:",t),null==t?void 0:t.data)f.toast.success("Registration successful! Redirecting to login..."),r({name:"",email:"",password:"",confirm_password:""}),setTimeout(()=>{e.push("/login")},1500);else throw Error("Invalid response from server")}catch(e){if(console.error("Registration process failed:",e),e.message.includes("timeout"))f.toast.error("Request timed out. Please check your internet connection and try again.");else if(e.message.includes("Network")||e.message.includes("Failed to fetch"))f.toast.error("Network error. Please check your internet connection and try again.");else if(e.message.includes("400")||e.message.includes("Validation"))f.toast.error("Invalid registration data. Please check your information and try again.");else if(e.message.includes("409")||e.message.includes("already exists"))f.toast.error("An account with this email already exists. Please use a different email or login.");else if(e.message.includes("500"))f.toast.error("Server error. Please try again later.");else{let s=(0,x.e$)(e);f.toast.error(s||"Registration failed. Please try again.")}}finally{w(!1)}}},handleChange=e=>{r(s=>({...s,[e.target.name]:e.target.value}))},y=s.name.trim()&&s.email.trim()&&s.password.length>=6&&s.confirm_password===s.password;return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-accent/20 to-background p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-md space-y-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center gap-3 mb-2",children:(0,a.jsx)("div",{className:"flex h-14 w-14 items-center justify-center rounded-xl bg-gradient-primary shadow-elevated",children:(0,a.jsx)(l.Z,{className:"h-8 w-8 text-primary-foreground"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:"HealthSaaS"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Join as a Community Health Worker"})]}),(0,a.jsxs)(p.Zb,{className:"shadow-elevated",children:[(0,a.jsxs)(p.Ol,{children:[(0,a.jsx)(p.ll,{children:"Create your account"}),(0,a.jsx)(p.SZ,{children:"Start making a difference in your community"})]}),(0,a.jsxs)(p.aY,{children:[(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g._,{htmlFor:"name",children:"Full Name *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(h.I,{id:"name",name:"name",type:"text",placeholder:"John Doe",value:s.name,onChange:handleChange,className:"pl-9",required:!0,disabled:n})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g._,{htmlFor:"email",children:"Email Address *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(h.I,{id:"email",name:"email",type:"email",placeholder:"chw@healthsaas.org",value:s.email,onChange:handleChange,className:"pl-9",required:!0,disabled:n})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g._,{htmlFor:"password",children:"Password *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(h.I,{id:"password",name:"password",type:"password",placeholder:"••••••••",value:s.password,onChange:handleChange,className:"pl-9",required:!0,minLength:6,disabled:n})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 6 characters long"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g._,{htmlFor:"confirm_password",children:"Confirm Password *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(h.I,{id:"confirm_password",name:"confirm_password",type:"password",placeholder:"••••••••",value:s.confirm_password,onChange:handleChange,className:"pl-9",required:!0,minLength:6,disabled:n})]}),s.confirm_password&&s.password!==s.confirm_password&&(0,a.jsx)("p",{className:"text-xs text-red-500",children:"Passwords do not match"})]}),(0,a.jsx)(u.z,{type:"submit",className:"w-full bg-gradient-primary hover:opacity-90",disabled:n||!y,children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating account..."]}):"Create account"})]}),(0,a.jsx)("div",{className:"mt-6 text-center text-sm",children:(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Already have an account?"," ",(0,a.jsx)(o(),{href:"/login",className:"font-medium text-primary hover:underline",onClick:e=>n&&e.preventDefault(),children:"Sign in"})]})}),(0,a.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-blue-800 text-center mb-1",children:"Having Issues?"}),(0,a.jsxs)("ul",{className:"text-xs text-blue-700 space-y-1",children:[(0,a.jsx)("li",{children:"• Check your internet connection"}),(0,a.jsx)("li",{children:"• Try disabling browser extensions temporarily"}),(0,a.jsx)("li",{children:"• Ensure your email is valid and accessible"})]})]})]})]})]})})}}},function(e){e.O(0,[919,937,430,971,472,744],function(){return e(e.s=26926)}),_N_E=e.O()}]);